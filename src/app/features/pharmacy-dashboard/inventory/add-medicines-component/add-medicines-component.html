<!-- add-medicines.component.html -->
<div class="add-medicines-container">
  <!-- Header -->
  <div class="header">
    <button class="back-button" routerLink="/pharmacy/medicinemanagement">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.42-1.41L7.83 13H20v-2z"/>
      </svg>
      Back to Medicines
    </button>
    <div class="header-content">
      <h1>Add Medicines</h1>
      <p>Search and add medicines to your inventory</p>
    </div>
  </div>

  <!-- Search Section -->
  <div class="search-section">
    <div class="search-header">
      <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
      </svg>
      <h2>Search Medicines Database</h2>
    </div>
    <p class="search-description">Find medicines from our verified database and add them to your inventory</p>
    
    <div class="search-input-container">
      <div class="search-input-wrapper">
        <svg class="input-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
        </svg>
        <input 
          type="search"
          #searchInput
          (input)="onSearchChange(searchInput.value)" 
          placeholder="Search by medicine name or category or active ingredient..."
          class="search-input"
        >
      </div>
      <button class="medicine-not-listed-btn">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
        </svg>
        Medicine Not Listed?
      </button>
    </div>
  </div>

  <!-- Selected Medicines Section -->
  @if (selectedMedicines.length > 0) {
    <div class="selected-medicines-section">
      <div class="selected-medicines-header">
        <div class="selected-medicines-title">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
          </svg>
          Selected Medicines
          <span class="selected-count">{{ selectedMedicines.length }} selected</span>
        </div>
        <button class="AddStock-button">Add To Stock</button>
      </div>
      <div class="selected-medicines-list">
        @for (medicine of selectedMedicines; track medicine) {
          <div class="selected-medicine-tag">
            {{ medicine.commonName }}
            <button class="remove-tag" (click)="removeMedicine(medicine)">
              <i class="remove-icon" aria-hidden="true">&times;</i>
            </button>
          </div>
        }
      </div>
    </div>
  }

  <!-- Medicine Cards Grid -->
  <div class="medicines-grid">
    @for (medicine of filteredMedicines; track medicine) {
      <div 
        class="medicine-card" 
        [class.selected]="checkSelectedMedicine(medicine)"
        (click)="onMedicineClick(medicine)"
      >
        <div class="medicine-card-content">
          <div class="medicine-icon">
            <img 
              [src]="medicine.drug_UrlImg"
              alt="{{ medicine.commonName }}" 
              class="medicine-image"
            >
          </div>
          <div class="medicine-info">
            <h3 class="medicine-name">{{ medicine.commonName }}</h3>
            <p class="medicine-ingredient">{{ medicine.activeIngredient }}</p>
            <p class="medicine-category">{{ medicine.category }}</p>
          </div>
        </div>
        <div class="selection-checkbox" (click)="$event.stopPropagation(); onMedicineSelect(medicine)">
          <div class="checkbox" [class.checked]="checkSelectedMedicine(medicine)">
            @if (checkSelectedMedicine(medicine)) {
              <svg width="12" height="12" viewBox="0 0 24 24" fill="white">
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
              </svg>
            }
          </div>
        </div>
      </div>
    }
  </div>

  <!-- Add Medicine Details Modal -->
  <!-- <app-add-medicine-details 
    *ngIf="showMedicineDetails && selectedMedicine"
    [medicine]="selectedMedicine"
    (close)="onCloseMedicineDetails()"
    (addToStock)="onAddToStock($event)"
  ></app-add-medicine-details> -->
</div>